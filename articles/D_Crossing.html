<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Crossing • SIMplyBee</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Crossing">
<meta property="og:description" content="SIMplyBee">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SIMplyBee</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">
    <span class="fa fa-question-circle"></span>
     
    Reference
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false">
    <span class="fa fa-book"></span>
     
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/A_Introduction_to_honeybee_biology.html">Introduction to honeybee biology</a>
    </li>
    <li>
      <a href="../articles/C_Colony_events.html">Colony Events</a>
    </li>
    <li>
      <a href="../articles/B_Multiple_colonies.html">Multiple colonies</a>
    </li>
    <li>
      <a href="../articles/D_Crossing.html">Crossing</a>
    </li>
    <li>
      <a href="../articles/E_Genomics.html">Genomics</a>
    </li>
    <li>
      <a href="../articles/G_Sampling_functions.html">Sampling functions</a>
    </li>
    <li>
      <a href="../articles/F_Quantitative_Genetics.html">Quantitative Genetics</a>
    </li>
    <li>
      <a href="../articles/Z_FAQs.html">FAQs</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/HighlanderLab/SIMplyBee/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Crossing</h1>
            
            <h4 data-toc-skip class="date">2023-12-20</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/HighlanderLab/SIMplyBee/blob/HEAD/vignettes/D_Crossing.Rmd" class="external-link"><code>vignettes/D_Crossing.Rmd</code></a></small>
      <div class="hidden name"><code>D_Crossing.Rmd</code></div>

    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>This vignette shows how you can cross virgin queens in SIMplyBee.
Here, we present how you can cross:</p>
<ul>
<li>single or multiple virgin queens (class <code>Pop</code>), virgin
queen in a colony (class <code>Colony</code>), or all the virgin queens
in an apiary or population (class <code>MultiColony</code>);</li>
<li>cross either with pre-selected population of drones or according to
a cross plan, and</li>
<li>cross queens at an open drone congregation area (DCA) or at a mating
station.</li>
</ul>
<p>Start by loading the package:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span>package <span class="op">=</span> <span class="st">"SIMplyBee"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Loading required package: AlphaSimR</span></span>
<span><span class="co">#&gt; Loading required package: R6</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Attaching package: 'SIMplyBee'</span></span>
<span><span class="co">#&gt; The following object is masked from 'package:base':</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;     split</span></span></code></pre></div>
<p>First, we create a founder population and some virgin queen, virgin
colonies, and virgin apiaries that we will later cross.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Simulate 40 founder genomes</span></span>
<span><span class="va">founderGenomes</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://gaynorr.github.io/AlphaSimR/reference/quickHaplo.html" class="external-link">quickHaplo</a></span><span class="op">(</span>nInd <span class="op">=</span> <span class="fl">50</span>, nChr <span class="op">=</span> <span class="fl">1</span>, segSites <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></span>
<span><span class="co"># Set global population paramaters</span></span>
<span><span class="va">SP</span> <span class="op">&lt;-</span> <span class="va"><a href="../reference/SimParamBee.html">SimParamBee</a></span><span class="op">$</span><span class="fu">new</span><span class="op">(</span><span class="va">founderGenomes</span><span class="op">)</span></span>
<span><span class="co"># Create a base population of 40 virgin queens</span></span>
<span><span class="va">basePop</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createCastePop.html">createVirginQueens</a></span><span class="op">(</span><span class="va">founderGenomes</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Prepare populations with a single virgin queen</span></span>
<span><span class="va">virginQueen1</span> <span class="op">&lt;-</span> <span class="va">basePop</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span><span class="va">virginQueen2</span> <span class="op">&lt;-</span> <span class="va">basePop</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span><span class="va">virginQueen3</span> <span class="op">&lt;-</span> <span class="va">basePop</span><span class="op">[</span><span class="fl">3</span><span class="op">]</span></span>
<span><span class="co"># Prepare populations with multiple virgin queens</span></span>
<span><span class="va">virginQueens1</span> <span class="op">&lt;-</span> <span class="va">basePop</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span></span>
<span><span class="va">virginQueens2</span> <span class="op">&lt;-</span> <span class="va">basePop</span><span class="op">[</span><span class="fl">7</span><span class="op">:</span><span class="fl">9</span><span class="op">]</span></span>
<span><span class="va">virginQueens3</span> <span class="op">&lt;-</span> <span class="va">basePop</span><span class="op">[</span><span class="fl">10</span><span class="op">:</span><span class="fl">12</span><span class="op">]</span></span>
<span><span class="co"># Prepare virgin Colony objects</span></span>
<span><span class="va">colony1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createColony.html">createColony</a></span><span class="op">(</span><span class="va">basePop</span><span class="op">[</span><span class="fl">13</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">colony2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createColony.html">createColony</a></span><span class="op">(</span><span class="va">basePop</span><span class="op">[</span><span class="fl">14</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">colony3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createColony.html">createColony</a></span><span class="op">(</span><span class="va">basePop</span><span class="op">[</span><span class="fl">15</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">colony4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createColony.html">createColony</a></span><span class="op">(</span><span class="va">basePop</span><span class="op">[</span><span class="fl">16</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co"># Prepare virgin MultiColony objects</span></span>
<span><span class="va">apiary1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createMultiColony.html">createMultiColony</a></span><span class="op">(</span><span class="va">basePop</span><span class="op">[</span><span class="fl">17</span><span class="op">:</span><span class="fl">21</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">apiary2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createMultiColony.html">createMultiColony</a></span><span class="op">(</span><span class="va">basePop</span><span class="op">[</span><span class="fl">22</span><span class="op">:</span><span class="fl">26</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">apiary3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createMultiColony.html">createMultiColony</a></span><span class="op">(</span><span class="va">basePop</span><span class="op">[</span><span class="fl">27</span><span class="op">:</span><span class="fl">31</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">apiary4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createMultiColony.html">createMultiColony</a></span><span class="op">(</span><span class="va">basePop</span><span class="op">[</span><span class="fl">32</span><span class="op">:</span><span class="fl">41</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p>We will now create a groups of drones from the remaining queens with
1,000 drones per queen that will represent a drone congregation area
(DCA).</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a DCA from the remaining virgin queens</span></span>
<span><span class="va">DCA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createCastePop.html">createDrones</a></span><span class="op">(</span><span class="va">basePop</span><span class="op">[</span><span class="fl">42</span><span class="op">:</span><span class="fl">50</span><span class="op">]</span>, nInd <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="cross-virgin-queens-at-an-open-dca">Cross virgin queens at an open DCA<a class="anchor" aria-label="anchor" href="#cross-virgin-queens-at-an-open-dca"></a>
</h2>
<div class="section level3">
<h3 id="cross-by-pre-selecting-drone-populations">Cross by pre-selecting drone populations<a class="anchor" aria-label="anchor" href="#cross-by-pre-selecting-drone-populations"></a>
</h3>
<p>We start by crossing our populations and colonies to pre-selected
populations of drones. We pre-select the groups by pulling a desired
number of drone packages from a DCA with the function
<code><a href="../reference/pullDroneGroupsFromDCA.html">pullDroneGroupsFromDCA()</a></code>. This function requires you to
specify a group of drones (<code>DCA</code>), how many groups you want
to pull from the DCA (<code>n</code>), and how many drones per group you
want (<code>nDrones</code>). For <code>nDrones</code>, you can either
specify an integer or a sampling function, which results in a different
number of drones in each of the pulled groups (you can read more about
this in the Sampling functions vignette). These sampling functions are
particularly useful in crossing simulations:</p>
<ul>
<li>
<code><a href="../reference/nFathersFun.html">nFathersPoisson()</a></code>: samples the number of drones from a
Poisson distribution with a default mean of 15 (the user can specify a
different mean) - the output can contain the value 0 and</li>
<li>
<code><a href="../reference/nFathersFun.html">nFathersTruncPoisson()</a></code>: samples the number of drones
from a zero truncated Poisson distribution with a default mean of 15
(the user can specif a different mean) - the output does not contain the
value 0.</li>
</ul>
<p>If these functions do not satisfy your needs, you can specify your
own sampling function(s).</p>
<p>We can pull the drone groups out separately for each crossing or pull
them out all at once.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Pre-select drone (father) populations from a DCA</span></span>
<span><span class="va">droneGroups</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/pullDroneGroupsFromDCA.html">pullDroneGroupsFromDCA</a></span><span class="op">(</span><span class="va">DCA</span>, n <span class="op">=</span> <span class="fl">20</span>, nDrones <span class="op">=</span> <span class="va">nFathersTruncPoisson</span><span class="op">)</span></span></code></pre></div>
<p>Once we inspect these drone groups, we see there is a different
number of drones in each group because we used a sampling function:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">sapply</a></span><span class="op">(</span><span class="va">droneGroups</span>, FUN <span class="op">=</span> <span class="va">nInd</span><span class="op">)</span></span>
<span><span class="co">#&gt;  [1] 10 13 16  9 12 14 21 16 15 20 16 11 15 17  9 18 16 18 17 18</span></span></code></pre></div>
<p>Now, we can cross our virgin queens to drone groups.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># A single virgin queen</span></span>
<span><span class="va">virginQueen1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross.html">cross</a></span><span class="op">(</span><span class="va">virginQueen1</span>, drones <span class="op">=</span> <span class="va">droneGroups</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/nCaste.html">nFathers</a></span><span class="op">(</span><span class="va">virginQueen1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 10</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Multiple virgin queens</span></span>
<span><span class="va">virginQueens1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross.html">cross</a></span><span class="op">(</span><span class="va">virginQueens1</span>, drones <span class="op">=</span> <span class="va">droneGroups</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/nCaste.html">nFathers</a></span><span class="op">(</span><span class="va">virginQueens1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 13 16  9</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># A colony</span></span>
<span><span class="va">colony1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross.html">cross</a></span><span class="op">(</span><span class="va">colony1</span>, drones <span class="op">=</span> <span class="va">droneGroups</span><span class="op">[[</span><span class="fl">5</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/nCaste.html">nFathers</a></span><span class="op">(</span><span class="va">colony1</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 12</span></span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># An apiary</span></span>
<span><span class="va">apiary1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross.html">cross</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">apiary1</span>, drones <span class="op">=</span> <span class="va">droneGroups</span><span class="op">[</span><span class="fl">6</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/nCaste.html">nFathers</a></span><span class="op">(</span><span class="va">apiary1</span><span class="op">)</span></span>
<span><span class="co">#&gt;  5  6  7  8  9 </span></span>
<span><span class="co">#&gt; 14 21 16 15 20</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="cross-according-to-a-cross-plan">Cross according to a cross plan<a class="anchor" aria-label="anchor" href="#cross-according-to-a-cross-plan"></a>
</h3>
<p>Another option is to provide a cross plan with IDs of the virgin
queens/colonies and drones, and a single drone population with all the
drones listed in the cross plan. You can create a cross plan with the
function <code><a href="../reference/createRandomCrossPlan.html">createRandomCrossPlan()</a></code>. This function creates a
cross plan by randomly sampling a desired number of drone IDs from a DCA
and assigning them to either virgin queen ID or colony ID. When crossing
a virgin queen from a colony, you have to provide the colony ID, since
there could be multiple virgin queens within the colony. In that case,
the random selection of one virgin queen occurs within the
<code><a href="../reference/cross.html">cross()</a></code> function. To create a cross plan you therefore have
to provide the IDs of either the virgin queens or the colonies you want
to cross (but not both in the same cross plan!!!), the drone population,
and the number of drones you want to cross to a particular virgin queen.
This can again be a fixed number or a sampling function. We can create a
separate cross plan for each mating or create one combined cross plan
for multiple matings (but can not have virgin queen and colony IDs in
the cross plan at the same time!!!). Here, we again mate a single virgin
queen, a population of virgin queens, virgin queens from a colony, and
from an apiary.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a combined cross for mating a single queen (virginQueen2) and a population</span></span>
<span><span class="co"># of virgin queen (virginQueens2)</span></span>
<span><span class="op">(</span><span class="va">crossPlanQueens</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createRandomCrossPlan.html">createRandomCrossPlan</a></span><span class="op">(</span>IDs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/getId.html">getId</a></span><span class="op">(</span><span class="va">virginQueen2</span><span class="op">)</span>,</span>
<span>                                                  <span class="fu"><a href="../reference/getId.html">getId</a></span><span class="op">(</span><span class="va">virginQueens2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                         drones <span class="op">=</span> <span class="va">DCA</span>,</span>
<span>                                         nDrones <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`2`</span></span>
<span><span class="co">#&gt;  [1] "1985" "1802" "7194" "630"  "1911" "1018" "3955" "5088" "5452" "1274"</span></span>
<span><span class="co">#&gt; [11] "2815" "3717" "8941" "6612" "2696"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`7`</span></span>
<span><span class="co">#&gt;  [1] "3205" "5855" "8813" "2565" "956"  "2957" "3567" "5221" "1449" "7116"</span></span>
<span><span class="co">#&gt; [11] "1500" "398"  "4282" "5631" "7480"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`8`</span></span>
<span><span class="co">#&gt;  [1] "3167" "4242" "7453" "982"  "2308" "1159" "7384" "136"  "2490" "5001"</span></span>
<span><span class="co">#&gt; [11] "6671" "2347" "2472" "7434" "6061"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`9`</span></span>
<span><span class="co">#&gt;  [1] "3430" "7003" "3686" "3883" "2451" "1359" "7978" "7687" "5950" "2821"</span></span>
<span><span class="co">#&gt; [11] "8516" "4333" "5524" "6020" "2275"</span></span></code></pre></div>
<p>We see that the created cross plan is a list with IDs corresponding
to the virgin queen’s IDs and the elements of each list being the IDs of
the drones the virgin queen will mate with. Now we can cross these
virgin queens by providing the <code>crossPlanQueens</code> to the
<code><a href="../reference/cross.html">cross()</a></code> functions.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cross a single virgin queen</span></span>
<span><span class="va">virginQueen2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross.html">cross</a></span><span class="op">(</span><span class="va">virginQueen2</span>, drones <span class="op">=</span> <span class="va">DCA</span>, crossPlan <span class="op">=</span> <span class="va">crossPlanQueens</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/nCaste.html">nFathers</a></span><span class="op">(</span><span class="va">virginQueen2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 15</span></span>
<span><span class="co"># Cross multiple virgin queens</span></span>
<span><span class="va">virginQueens2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross.html">cross</a></span><span class="op">(</span><span class="va">virginQueens2</span>, drones <span class="op">=</span> <span class="va">DCA</span>, crossPlan <span class="op">=</span> <span class="va">crossPlanQueens</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/nCaste.html">nFathers</a></span><span class="op">(</span><span class="va">virginQueens2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 15 15 15</span></span></code></pre></div>
<p>As already mentioned, we need to create a separate plan for crossing
virgin queens already in colonies, since here we need to provide colony
IDs.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="op">(</span><span class="va">crossPlanColonies</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createRandomCrossPlan.html">createRandomCrossPlan</a></span><span class="op">(</span>IDs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/getId.html">getId</a></span><span class="op">(</span><span class="va">colony2</span><span class="op">)</span>, <span class="fu"><a href="../reference/getId.html">getId</a></span><span class="op">(</span><span class="va">apiary2</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                           drones <span class="op">=</span> <span class="va">DCA</span>,</span>
<span>                                           nDrones <span class="op">=</span> <span class="va">nFathersPoisson</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; $`2`</span></span>
<span><span class="co">#&gt;  [1] "3857" "6748" "8866" "4451" "3427" "8891" "6384" "8792" "3644" "8135"</span></span>
<span><span class="co">#&gt; [11] "7748" "6614" "4494" "5627" "5310" "4893" "4160" "2180" "5747" "6559"</span></span>
<span><span class="co">#&gt; [21] "2117"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`10`</span></span>
<span><span class="co">#&gt;  [1] "4602" "2517" "3511" "8198" "3001" "1594" "508"  "2769" "4218" "6591"</span></span>
<span><span class="co">#&gt; [11] "848"  "5451" "938"  "8726" "5424" "215"  "8802"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`11`</span></span>
<span><span class="co">#&gt;  [1] "8527" "6261" "8036" "1270" "4821" "6988" "5689" "6868" "5795" "2854"</span></span>
<span><span class="co">#&gt; [11] "346"  "4530" "5629" "7196" "2071" "5904"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`12`</span></span>
<span><span class="co">#&gt;  [1] "5294" "277"  "8814" "7311" "2418" "403"  "1978" "125"  "6968" "6490"</span></span>
<span><span class="co">#&gt; [11] "4920" "8046" "8280" "855"  "4870" "1299" "2660" "6906" "3809"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`13`</span></span>
<span><span class="co">#&gt;  [1] "6999" "8873" "2524" "7634" "2914" "4221" "2162" "2086" "2689" "3819"</span></span>
<span><span class="co">#&gt; [11] "8830" "4955" "7856"</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $`14`</span></span>
<span><span class="co">#&gt;  [1] "2929" "1115" "7056" "1992" "5018" "2573" "1043" "1030" "3551" "1036"</span></span>
<span><span class="co">#&gt; [11] "1876" "1373" "524"  "1889" "257"  "5380" "970"</span></span></code></pre></div>
<p>We again see that the cross plan is a list, now with colony IDs and
elements of the list being the ID of drones the virgin queen within each
colony will mate with. Now, we can cross our “colonies” by providing the
<code>crossPlanColonies</code> to the <code><a href="../reference/cross.html">cross()</a></code> function.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Cross a single colony</span></span>
<span><span class="va">colony2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross.html">cross</a></span><span class="op">(</span><span class="va">colony2</span>, drones <span class="op">=</span> <span class="va">DCA</span>, crossPlan <span class="op">=</span> <span class="va">crossPlanColonies</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/nCaste.html">nFathers</a></span><span class="op">(</span><span class="va">colony2</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 21</span></span>
<span><span class="co"># Cross an apiary</span></span>
<span><span class="va">apiary2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross.html">cross</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">apiary2</span>, drones <span class="op">=</span> <span class="va">DCA</span>, crossPlan <span class="op">=</span> <span class="va">crossPlanColonies</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/nCaste.html">nFathers</a></span><span class="op">(</span><span class="va">apiary2</span><span class="op">)</span></span>
<span><span class="co">#&gt; 10 11 12 13 14 </span></span>
<span><span class="co">#&gt; 17 16 19 13 17</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="cross-virgin-queens-at-a-mating-station">Cross virgin queens at a mating station<a class="anchor" aria-label="anchor" href="#cross-virgin-queens-at-a-mating-station"></a>
</h2>
<p>Mating virgin queens at a mating station is no different than mating
them at an open DCA - the difference is in the DCA itself. In the case
of open mating, the DCA consists of drones from multiple queens, all of
which are usually unknown. In the case of a mating station, the DCA
consists of drones coming from a sister group of drone producing queens
(DPQ), the queen of which is known. This allows us to track the pedigree
on the paternal side.</p>
<p>To simulate this situation, we first create a mating station DCA
using <code><a href="../reference/createMatingStationDCA.html">createMatingStationDCA()</a></code> function, which takes a
single “sire” colony (queen of the DPQs). From the “sire” colony, the
function first produces a desired number of sister DPQs, and next
produces a desired number of drones per DPQ. The produced drones
represent the mating station’s DCA.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a DCA at a mating station from colony1</span></span>
<span><span class="op">(</span><span class="va">matingStationDCA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createMatingStationDCA.html">createMatingStationDCA</a></span><span class="op">(</span><span class="va">colony1</span>, nDPQs <span class="op">=</span> <span class="fl">20</span>, nDronePerDPQ <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; An object of class "Pop" </span></span>
<span><span class="co">#&gt; Ploidy: 2 </span></span>
<span><span class="co">#&gt; Individuals: 20000 </span></span>
<span><span class="co">#&gt; Chromosomes: 1 </span></span>
<span><span class="co">#&gt; Loci: 100 </span></span>
<span><span class="co">#&gt; Traits: 0</span></span></code></pre></div>
<p>We see that the output of the function is a single population of
20,000 drones that represents the DCA. Once you have the DCA, you can
cross virgin queens either by pulling out populations of drones or
creating a mating plan as described above.</p>
<p>Here, we will mate a single colony (<code>colony3</code>) and a group
of colonies (<code>apiary3</code>) at a mating station according to a
cross plan.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Mate only an apiary</span></span>
<span><span class="va">crossPlanMatingStation</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/createRandomCrossPlan.html">createRandomCrossPlan</a></span><span class="op">(</span>IDs <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fu"><a href="../reference/getId.html">getId</a></span><span class="op">(</span><span class="va">colony3</span><span class="op">)</span>, </span>
<span>                                                        <span class="fu"><a href="../reference/getId.html">getId</a></span><span class="op">(</span><span class="va">apiary3</span><span class="op">)</span><span class="op">)</span>,</span>
<span>                                                drones <span class="op">=</span> <span class="va">matingStationDCA</span>,</span>
<span>                                                nDrones <span class="op">=</span> <span class="va">nFathersTruncPoisson</span><span class="op">)</span></span>
<span><span class="co"># Cross a colony</span></span>
<span><span class="va">colony3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross.html">cross</a></span><span class="op">(</span><span class="va">colony3</span>, crossPlan <span class="op">=</span> <span class="va">crossPlanMatingStation</span>, drones <span class="op">=</span> <span class="va">matingStationDCA</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/nCaste.html">nFathers</a></span><span class="op">(</span><span class="va">colony3</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 18</span></span>
<span><span class="co"># Cross an apiary</span></span>
<span><span class="va">apiary3</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross.html">cross</a></span><span class="op">(</span><span class="va">apiary3</span>, crossPlan <span class="op">=</span> <span class="va">crossPlanMatingStation</span>, drones <span class="op">=</span> <span class="va">matingStationDCA</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/nCaste.html">nFathers</a></span><span class="op">(</span><span class="va">apiary3</span><span class="op">)</span></span>
<span><span class="co">#&gt; 15 16 17 18 19 </span></span>
<span><span class="co">#&gt; 22 19 20 19 15</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="cross-virgin-queens-with-different-methods">Cross virgin queens with different methods<a class="anchor" aria-label="anchor" href="#cross-virgin-queens-with-different-methods"></a>
</h2>
<p>It could happen that you have some virgin colonies in an apiary and
you want to inseminate one of the virgin queens artificially with a
single drone, take three of them to a mating station, and mate the rest
of them openly at a local DCA. Since the cross plan is a named list, you
can concatenate multiple cross plans into one. Let’s mate the
multicolony <code>apiary4</code> in such a manner.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Create a single drone for single drone insemination</span></span>
<span><span class="va">singleDrone</span> <span class="op">=</span> <span class="fu"><a href="../reference/createCastePop.html">createDrones</a></span><span class="op">(</span><span class="va">colony2</span>, nInd <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="co"># Create a cross plan for crossing some of the colonies in an open DCA, </span></span>
<span><span class="co"># some with single drone, and some on a mating station</span></span>
<span><span class="va">crossPlanApiary4</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/createRandomCrossPlan.html">createRandomCrossPlan</a></span><span class="op">(</span>IDs <span class="op">=</span> <span class="fu"><a href="../reference/getId.html">getId</a></span><span class="op">(</span><span class="va">apiary4</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>, </span>
<span>                        drones <span class="op">=</span> <span class="va">singleDrone</span>, </span>
<span>                        nDrones <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/createRandomCrossPlan.html">createRandomCrossPlan</a></span><span class="op">(</span>IDs <span class="op">=</span> <span class="fu"><a href="../reference/getId.html">getId</a></span><span class="op">(</span><span class="va">apiary4</span><span class="op">)</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">6</span><span class="op">]</span>, </span>
<span>                        drones <span class="op">=</span> <span class="va">DCA</span>, </span>
<span>                        nDrones <span class="op">=</span> <span class="va">nFathersTruncPoisson</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/createRandomCrossPlan.html">createRandomCrossPlan</a></span><span class="op">(</span>IDs <span class="op">=</span> <span class="fu"><a href="../reference/getId.html">getId</a></span><span class="op">(</span><span class="va">apiary4</span><span class="op">)</span><span class="op">[</span><span class="fl">7</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, </span>
<span>                        drones <span class="op">=</span> <span class="va">matingStationDCA</span>, </span>
<span>                        nDrones <span class="op">=</span> <span class="va">nFathersTruncPoisson</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span></span>
<span><span class="va">apiary4</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/cross.html">cross</a></span><span class="op">(</span><span class="va">apiary4</span>, </span>
<span>                 crossPlan <span class="op">=</span> <span class="va">crossPlanApiary4</span>, </span>
<span>                 drones <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">singleDrone</span>, <span class="va">DCA</span>, <span class="va">matingStationDCA</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/nCaste.html">nFathers</a></span><span class="op">(</span><span class="va">apiary4</span><span class="op">)</span></span>
<span><span class="co">#&gt; 20 21 22 23 24 25 26 27 28 29 </span></span>
<span><span class="co">#&gt;  1 20 11 16 14 15 24 11 15 19</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p></p>
<p>Developed by Jana Obšteter, Laura Strachan, Jernej Bubnič, Gregor Gorjanc.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
